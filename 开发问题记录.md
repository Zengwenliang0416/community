# 发布帖子

点击提交后，页面没有响应，数据库也没有插入成功。

原因1:

index.js文件中获取标题内容时忘记加上.val()

```javascript
function publish() {
	$("#publishModal").modal("hide");
	// 获取标题和内容
	var title = $("#recipient-name").val();
	var content = $("#message-text").val();
	// 发送异步请求（POST）
	$.post(...
```

原因2:

数据库配置文件中`values(#{userId},#{title},#{content},#{type},#{status},#{createTime},#{commentCount},#{score})`中的大括号写成了小括号

```mysql
    <insert id="insertDiscussPost" parameterType="DiscussPost">
        insert into discuss_post(<include refid="insertFields"></include>)
        values(#{userId},#{title},#{content},#{type},#{status},#{createTime},#{commentCount},#{score})
    </insert>
```

# 回复帖子

回复帖子后出现一下内容

```
Whitelabel Error Page
This application has no explicit mapping for /error, so you are seeing this as a fallback.

Thu Jul 13 15:08:17 CST 2023
There was an unexpected error (type=Not Found, status=404).
No message available
```

提交返回路径时`<form class="replyform" method="post" th:action="@{|/comment/add/${post.id}|}">`写成了`<form class="replyform" method="post" th:action="@{|comment/add/${post.id}|}">`

# 私信列表

分页失败

在Controllor中路径拼接错误导致

```java
        page.setLimit(5);
        page.setPath("/letter/detail/"+conversationId);
        page.setRows(messageService.findLetterCount(conversationId));
        //写成了
        page.setLimit(5);
        page.setPath("/letter/detail"+conversationId);
        page.setRows(messageService.findLetterCount(conversationId));
```

# 发送列表

发送消息之后没有出现提示，控制台出现这个错误

```
2023-07-14 16:28:37,067 WARN [http-nio-8080-exec-1] o.s.w.s.m.s.DefaultHandlerExceptionResolver [AbstractHandlerExceptionResolver.java:198] Resolved [org.springframework.web.HttpRequestMethodNotSupportedException: Request method 'POST' not supported]
```

# 统一异常信息

页面不提示如下信息：

![image-20230714175138782](https://gitee.com/wenliang_zeng/md/raw/master/image-20230714175138782.png)



ExceptionAdvice中代码

```java
        String xRequestedWith = request.getHeader("x-requested-with");
        if ("XMLHttpRequest".equals(xRequestedWith)) {//XMLHttpRequest写成了XMLHTTPRequest
            response.setContentType("application/plain;charset=utf-8");
            PrintWriter writer = response.getWriter();
            writer.write(CommunityUtil.getJSONString(1,"服务器异常！"));
        }else {
            response.sendRedirect(request.getContextPath()+"/");
        }
```

# 统一日志信息

出现如下错误

![image-20230714195615425](https://gitee.com/wenliang_zeng/md/raw/master/image-20230714195615425.png)

ServiceLogAspect中代码`logger.info(String.format("用户[%s],在[%s],访问了[%s].",ip,now,target));`写成了`logger.info(String.format("用户[%s],在[%S],访问了[%s]."),ip,now,target);`
